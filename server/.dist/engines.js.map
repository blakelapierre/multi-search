{"version":3,"sources":["engines.ts"],"names":[],"mappings":"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","file":"engines.js","sourcesContent":["import {createEvaluator} from './createEvaluator';\n\nclass Engine {\n  constructor(public name, public queryUrl, public evaluator) { }\n\n  private _cache = new Cache();\n\n  get cache() {\n    return this._cache;\n  }\n}\n\nclass Cache {\n  private store = {};\n\n  retrieve(key) {\n    return this.store[key];\n  }\n\n  put(key, data) {\n    return this.store[key] = data;\n  }\n}\n\n//                                        v compiler trick!\nconst googleEvaluator = createEvaluator(({map, reduce}) => {\n  const results = document.querySelectorAll('.srg > .g');\n\n  // {\n  //   titles: oreduce({'.r': (agg, result, i) => agg.concat(result.innerText || 'ERROR: NO INNER TEXT!!!'), [])}),\n  //   snippet: {'.rc .s .st': a => a.innerText},\n  //   url: {'.rc .r a': a => a.getAttribute('href')},\n  //   images: omap({'img': r => ({src: r.getAttribute('src'), width: r.getAttribute('width'), height: r.getAttribute('height')})})\n  // }\n\n  return reduce(results, (agg, result, i) => agg.concat({\n    titles: reduce(result.querySelectorAll('.r'), (agg, result, i) => agg.concat(result.innerText || 'ERROR: NO INNER TEXT!!!'), []),\n    snippet: result.querySelector('.rc .s .st').innerText,\n    url: result.querySelector('.rc .r a').getAttribute('href'),\n    images: map(result.querySelectorAll('img'), r => ({src: r.getAttribute('src'), width: r.getAttribute('width'), height: r.getAttribute('height')}))\n  }), []);\n});\n\nconst duckduckgoEvaluator = createEvaluator(({map, reduce}) => {\n  const results = document.querySelectorAll('#links.results > .result.results_links_deep');\n\n  return reduce(results, (agg, result, i) => agg.concat({\n    titles: reduce(result.querySelectorAll('.result__title > *:not(.result__check)'), (agg, result, i) => agg.concat(result.innerText), []),\n    snippet: result.querySelector('.result__snippet').innerText,\n    url: result.querySelector('.result__url').getAttribute('href'),\n    images: map(result.querySelectorAll('img:not(.result__icon__img)'), r => ({src: (r.getAttribute('src') || '').replace(/^\\/[^\\/]/, 'http://duckduckgo.com/'), width: r.getAttribute('width'), height: r.getAttribute('height')}))\n  }), []);\n});\n\nconst bingEvaluator = createEvaluator(({map, reduce}) => {\n  const results = document.querySelectorAll('#b_results .b_algo');\n\n  return reduce(results, (agg, result, i) => agg.concat({\n    titles: reduce(result.querySelectorAll('h2 a'), (agg, result, i) => result.innerText === '' ? agg : agg.concat(result.innerText), []),\n    snippet: (result.querySelector('.b_caption p') || {}).innerText,\n    url: result.querySelector('h2 > a').getAttribute('href'),\n    images: map(result.querySelectorAll('img'), r => ({src: (r.getAttribute('src') || '').replace(/^\\/[^\\/]/, 'https://www.bing.com/'), width: r.getAttribute('width'), height: r.getAttribute('height')}))\n  }), []);\n});\n\nconst yahooEvaluator = createEvaluator(({map, reduce}) => {\n  const results = document.querySelectorAll('.dd.algo.algo-sr');\n\n  return reduce(results, (agg, result, i) => agg.concat({\n    titles: reduce(result.querySelectorAll('.title > a'), (agg, result, i) => agg.concat(result.innerText), []),\n    snippet: (result.querySelector('.compText p') || {}).innerText,\n    url: result.querySelector('.title > a').getAttribute('href'),\n    images: map(result.querySelectorAll('img'), r => ({src: r.getAttribute('src') , width: r.getAttribute('width'), height: r.getAttribute('height')}))\n  }), []);\n});\n\nconst Google = new Engine('Google','https://google.com/search?q=', googleEvaluator),\n      DuckDuckGo = new Engine('DuckDuckGo', 'https://duckduckgo.com?q=', duckduckgoEvaluator),\n      Bing = new Engine('Bing', 'https://bing.com?q=', bingEvaluator),\n      Yahoo = new Engine('Yahoo', 'https://search.yahoo.com/search?p=', yahooEvaluator),\n\n      engines = [ Google, DuckDuckGo, Bing, Yahoo ];\n\nexport default engines;\n"]}